scope {
	buff = binary()
	buff.writer() {|w|
		x = @@{{1, 2, 3}, {4, 5, 6}, {7, 8, 9}}
		w.serialize(x)
		println(x)
	}
	buff.reader() {|r|
		x = r.deserialize()
		println(x)
	}
}
sys.exit()
scope {
	f() = {
		buff = binary()
		buff.writer() {|w|
			x = `a('A', 'B', 1, 2) {} b(1, 2, 3) {}
			w.serialize(x)
			println(x)
		}
		buff.reader() {|r|
			x = r.deserialize()
			println(x)
		}
	}
	println(f.expr)
	buff = binary()
	buff.writer() {|w|
		w.serialize(f.expr)
	}
	buff.dump()
	buff.reader() {|r|
		println(r.deserialize())
	}
}
scope {
	buff = binary()
	buff.writer() {|w|
		x = `a('A', 'B', 1, 2) {} b(1, 2, 3) {}
		w.serialize(x)
		println(x)
	}
	buff.reader() {|r|
		x = r.deserialize()
		println(x)
	}
}
scope {
	buff = binary()
	buff.writer() {|w|
		w.serialize('hello world')
	}
	buff.reader() {|r|
		println(r.deserialize())
	}
}
scope {
	buff = binary()
	buff.writer() {|w|
		w.serialize(['hello world', 'line1', 'line2'])
	}
	buff.reader() {|r|
		println(r.deserialize()):nomap
	}
}
scope {
	buff = binary()
	buff.writer() {|w|
		w.serialize([12345, 3.1415926, 'hello world', 3 + 2j])
	}
	buff.dump()
	buff.reader() {|r|
		println(r.deserialize()):nomap
	}
}
