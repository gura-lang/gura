#!/usr/bin/env gura
import(helper.test) {*}
import(ml.mnist)
import(arrayt)

db = ml.mnist.Database('sample')


testcase {
	arrImage = db.train.imageSet.ToArray(`flat)
	arrLabel = db.train.labelSet.ToArray()
	x = arrImage[0].reshape([1, nil])
	t = arrLabel[0].reshape([1, nil])
	weight = array@float.rands@normal([784, 10], 0, .1)
	bias = array@float.rands@normal([1, 10], 0, .1)
	model = `(x |.| weight + bias)
	ml.mnist.test(model)
}
