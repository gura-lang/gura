#!/usr/bin/env gura
import(helper.test) {*}
import(mtp)

/*
testcase {
	//mtp.test()
	mtp.detect_devices().each {|device|
		println(device.friendlyName)
		storages = device.GetStorages()
		storages.each {|storage|
			printf('id:                 0x%08x\n', storage.id)
			printf('storageType:        %s\n', storage.storageType)
			printf('filesystemType:     %s\n', storage.filesystemType)
			printf('accessCapability:   %s\n', storage.accessCapability)
			printf('maxCapacity:        %d\n', storage.maxCapacity)
			printf('freeSpaceInBytes:   %d\n', storage.freeSpaceInBytes)
			printf('freeSpaceInObjects: %d\n', storage.freeSpaceInObjects)
			printf('storageDescription: %s\n', storage.storageDescription)
			printf('volumeIdentifier:   %s\n', storage.volumeIdentifier)
			println('-----')
			stats = path.walk(storage.opendir('/')):stat
			printf('%-32s %s %d\n', stats:*dirname, stats:*mtime, stats:*size);
		}
	}
}
*/
testcase {
	device = mtp.detect_devices()[0]
	storage = device.GetStorages()[0]
	//stats = path.walk(storage.opendir('/')):stat
	//printf('%-32s %s %d\n', stats:*pathname, stats:*mtime, stats:*size);
	stream.copy(storage.reader('/DCIM/Camera/IMG_20180506_111127.jpg'), 'IMG_2018_0506_111127.jpg')
}
