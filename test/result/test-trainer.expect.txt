======== #1 node information ========

node@a = +a .. unary@pos
node@a.input .. nil
node@a.inputgrad .. nil
node@a = -a .. unary@neg
node@a.input .. nil
node@a.inputgrad .. nil
node@a = a + b .. binary@add
node@a.input@left .. nil
node@a.input@right .. nil
node@a.inputgrad@left .. nil
node@a.inputgrad@right .. nil
node@a = a - b .. binary@sub
node@a.input@left .. nil
node@a.input@right .. nil
node@a.inputgrad@left .. nil
node@a.inputgrad@right .. nil
node@a = a * b .. binary@mul
node@a.input@left .. nil
node@a.input@right .. nil
node@a.inputgrad@left .. nil
node@a.inputgrad@right .. nil
node@a = a / b .. binary@div
node@a.input@left .. nil
node@a.input@right .. nil
node@a.inputgrad@left .. nil
node@a.inputgrad@right .. nil
node@a = a ** b .. binary@pow
node@a.input@left .. nil
node@a.input@right .. nil
node@a.inputgrad@left .. nil
node@a.inputgrad@right .. nil
node@a = a |.| b .. binary@dot
node@a.input@left .. nil
node@a.input@right .. nil
node@a.inputgrad@left .. nil
node@a.inputgrad@right .. nil
node@a = a |*| gear@conv1d(array.zeros([3])) .. gear@conv1d
<gear@conv1d:filter_num=none:channel_num=none:size=3:strides=1:padding=same:channel_pos=none>
node@a.input .. nil
node@a.inputgrad .. nil
node@a = a |*| gear@conv2d(array.zeros([3, 3])) .. gear@conv2d
<gear@conv2d:filter_num=none:channel_num=none:size=(3,3):strides=(1,1):padding=same:channel_pos=none>
node@a.input .. nil
node@a.inputgrad .. nil
node@a = a |*| gear@maxpool1d(3) .. gear@maxpool1d
<gear@maxpool1d:size=3:strides=1:padding=same:channel_pos=last>
node@a.input .. nil
node@a.inputgrad .. nil
node@a = a |*| gear@maxpool2d([3, 3]) .. gear@maxpool2d
<gear@maxpool2d:size=(3,3):strides=(1,1):padding=same:channel_pos=last>
node@a.input .. nil
node@a.inputgrad .. nil
node@a = a |*| gear@maxpool3d([3, 3, 3]) .. gear@maxpool3d
<gear@maxpool2d:size=(3,3,3):strides=(1,1,1):padding=same:channel_pos=last>
node@a.input .. nil
node@a.inputgrad .. nil
node@a = a |*| gear@relu() .. gear@relu
<gear@relu>
node@a.input .. nil
node@a.inputgrad .. nil
node@a = a |*| gear@sigmoid() .. gear@sigmoid
<gear@sigmoid>
node@a.input .. nil
node@a.inputgrad .. nil
node@a = a |*| gear@softmax() .. gear@softmax
<gear@softmax>
node@a.input .. nil
node@a.inputgrad .. nil
node@a = a |*| gear@tanh() .. gear@tanh
<gear@tanh>
node@a.input .. nil
node@a.inputgrad .. nil

======== #2 input values in trainer#eval() ========

no inputs specified
{ x = 3, tr.eval() } .. 3
{ x = 5, tr.eval() } .. 3
x is specified as an input
{ x = 7, tr.eval() } .. 7
{ x = 9, tr.eval() } .. 9

======== #3 trainer#eval() ========

a + b
{ a = 3, b = 5, tr.eval() } .. 8
a - b
{ a = 3, b = 5, tr.eval() } .. -2
a * b
{ a = 3, b = 5, tr.eval() } .. 15
a / b
{ a = 3, b = 5, tr.eval() } .. 0.6
a |.| b
{ a = 3, b = 5, tr.eval() } .. 15

======== #4 gear@conv2d ========

------------------------------------------------------------------------------
target:[H, W] filter:[FH, FW]
model .. x |*| g
x.shape .. [5, 5]
g .. <gear@conv2d:filter_num=none:channel_num=none:size=(2,2):strides=(1,1):padding=valid:channel_pos=none>
x.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{0, 0, 0, 0, 1},
 {0, 0, 1, 1, 0},
 {1, 1, 1, 0, 0},
 {0, 1, 0, 0, 1},
 {1, 1, 0, 1, 1}}
g.array.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{1, 0},
 {0, 0}}
== OK ==
strDirect ..
{{0, 0, 0, 0},
 {0, 0, 1, 1},
 {1, 1, 1, 0},
 {0, 1, 0, 0}}
strTrainer ..
{{0, 0, 0, 0},
 {0, 0, 1, 1},
 {1, 1, 1, 0},
 {0, 1, 0, 0}}
------------------------------------------------------------------------------
target:[H, W] filter:[FN, FH, FW]
model .. x |*| g
x.shape .. [5, 5]
g .. <gear@conv2d:filter_num=4:channel_num=none:size=(2,2):strides=(1,1):padding=valid:channel_pos=none>
x.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{0, 0, 0, 0, 1},
 {0, 0, 1, 1, 0},
 {1, 1, 1, 0, 0},
 {0, 1, 0, 0, 1},
 {1, 1, 0, 1, 1}}
g.array.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{1, 0},
  {0, 0}},

 {{1, 0},
  {1, 0}},

 {{0, 0},
  {1, 0}},

 {{1, 1},
  {0, 0}}}
== OK ==
strDirect ..
{{{0, 0, 0, 0}, {0, 0, 0, 0}, {0, 1, 1, 0}, {0, 1, 1, 1}},
 {{0, 1, 1, 0}, {0, 1, 1, 1}, {1, 2, 1, 2}, {1, 1, 0, 1}},
 {{1, 1, 0, 2}, {1, 2, 1, 2}, {1, 1, 0, 1}, {0, 0, 0, 0}},
 {{0, 1, 1, 1}, {1, 2, 1, 1}, {0, 0, 0, 0}, {0, 1, 1, 1}}}
strTrainer ..
{{{0, 0, 0, 0}, {0, 0, 0, 0}, {0, 1, 1, 0}, {0, 1, 1, 1}},
 {{0, 1, 1, 0}, {0, 1, 1, 1}, {1, 2, 1, 2}, {1, 1, 0, 1}},
 {{1, 1, 0, 2}, {1, 2, 1, 2}, {1, 1, 0, 1}, {0, 0, 0, 0}},
 {{0, 1, 1, 1}, {1, 2, 1, 1}, {0, 0, 0, 0}, {0, 1, 1, 1}}}
------------------------------------------------------------------------------
target:[N, H, W] filter:[FN, FH, FW]
x.expand_kernelvec2d([2, 2], [1, 1], [0, 0], `none) ..
{{{0, 0, 0, 0},
  {0, 0, 0, 1},
  {0, 0, 1, 1},
  {0, 1, 1, 0},
  {0, 0, 1, 1},
  {0, 1, 1, 1},
  {1, 1, 1, 0},
  {1, 0, 0, 0},
  {1, 1, 0, 1},
  {1, 1, 1, 0},
  {1, 0, 0, 0},
  {0, 0, 0, 1},
  {0, 1, 1, 1},
  {1, 0, 1, 0},
  {0, 0, 0, 1},
  {0, 1, 1, 1}},

 {{1, 0, 0, 1},
  {0, 0, 1, 0},
  {0, 0, 0, 0},
  {0, 1, 0, 0},
  {0, 1, 1, 0},
  {1, 0, 0, 1},
  {0, 0, 1, 1},
  {0, 0, 1, 0},
  {1, 0, 0, 1},
  {0, 1, 1, 0},
  {1, 1, 0, 1},
  {1, 0, 1, 0},
  {0, 1, 0, 1},
  {1, 0, 1, 1},
  {0, 1, 1, 1},
  {1, 0, 1, 0}},

 {{0, 1, 0, 0},
  {1, 0, 0, 0},
  {0, 1, 0, 0},
  {1, 1, 0, 0},
  {0, 0, 0, 1},
  {0, 0, 1, 1},
  {0, 0, 1, 1},
  {0, 0, 1, 1},
  {0, 1, 1, 1},
  {1, 1, 1, 0},
  {1, 1, 0, 1},
  {1, 1, 1, 0},
  {1, 1, 0, 1},
  {1, 0, 1, 0},
  {0, 1, 0, 0},
  {1, 0, 0, 1}}}
model .. x |*| g
x.shape .. [3, 5, 5]
g .. <gear@conv2d:filter_num=4:channel_num=none:size=(2,2):strides=(1,1):padding=valid:channel_pos=none>
x.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{0, 0, 0, 0, 1},
  {0, 0, 1, 1, 0},
  {1, 1, 1, 0, 0},
  {0, 1, 0, 0, 1},
  {1, 1, 0, 1, 1}},

 {{1, 0, 0, 0, 1},
  {0, 1, 0, 0, 0},
  {1, 0, 1, 1, 0},
  {0, 1, 0, 1, 0},
  {0, 1, 1, 1, 0}},

 {{0, 1, 0, 1, 1},
  {0, 0, 0, 0, 0},
  {0, 1, 1, 1, 1},
  {1, 1, 0, 1, 0},
  {0, 1, 0, 0, 1}}}
g.array.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{0, 0},
  {1, 0}},

 {{1, 1},
  {1, 1}},

 {{1, 0},
  {1, 0}},

 {{1, 1},
  {0, 1}}}
== OK ==
strDirect ..
{{{{0, 0, 0, 0}, {0, 1, 0, 1}, {1, 2, 1, 1}, {1, 2, 1, 1}},
  {{1, 2, 1, 1}, {1, 3, 1, 2}, {1, 3, 2, 2}, {0, 1, 1, 1}},
  {{0, 3, 1, 3}, {1, 3, 2, 2}, {0, 1, 1, 1}, {0, 1, 0, 1}},
  {{1, 3, 1, 2}, {1, 2, 2, 1}, {0, 1, 0, 1}, {1, 3, 1, 2}}},

 {{{0, 2, 1, 2}, {1, 1, 1, 0}, {0, 0, 0, 0}, {0, 1, 0, 1}},
  {{1, 2, 1, 1}, {0, 2, 1, 2}, {1, 2, 1, 1}, {1, 1, 1, 0}},
  {{0, 2, 1, 2}, {1, 2, 1, 1}, {0, 3, 1, 3}, {1, 2, 2, 1}},
  {{0, 2, 0, 2}, {1, 3, 2, 2}, {1, 3, 1, 2}, {1, 2, 2, 1}}},

 {{{0, 1, 0, 1}, {0, 1, 1, 1}, {0, 1, 0, 1}, {0, 2, 1, 2}},
  {{0, 1, 0, 1}, {1, 2, 1, 1}, {1, 2, 1, 1}, {1, 2, 1, 1}},
  {{1, 3, 1, 2}, {1, 3, 2, 2}, {0, 3, 1, 3}, {1, 3, 2, 2}},
  {{0, 3, 1, 3}, {1, 2, 2, 1}, {0, 1, 0, 1}, {0, 2, 1, 2}}}}
strTrainer ..
{{{{0, 0, 0, 0}, {0, 1, 0, 1}, {1, 2, 1, 1}, {1, 2, 1, 1}},
  {{1, 2, 1, 1}, {1, 3, 1, 2}, {1, 3, 2, 2}, {0, 1, 1, 1}},
  {{0, 3, 1, 3}, {1, 3, 2, 2}, {0, 1, 1, 1}, {0, 1, 0, 1}},
  {{1, 3, 1, 2}, {1, 2, 2, 1}, {0, 1, 0, 1}, {1, 3, 1, 2}}},

 {{{0, 2, 1, 2}, {1, 1, 1, 0}, {0, 0, 0, 0}, {0, 1, 0, 1}},
  {{1, 2, 1, 1}, {0, 2, 1, 2}, {1, 2, 1, 1}, {1, 1, 1, 0}},
  {{0, 2, 1, 2}, {1, 2, 1, 1}, {0, 3, 1, 3}, {1, 2, 2, 1}},
  {{0, 2, 0, 2}, {1, 3, 2, 2}, {1, 3, 1, 2}, {1, 2, 2, 1}}},

 {{{0, 1, 0, 1}, {0, 1, 1, 1}, {0, 1, 0, 1}, {0, 2, 1, 2}},
  {{0, 1, 0, 1}, {1, 2, 1, 1}, {1, 2, 1, 1}, {1, 2, 1, 1}},
  {{1, 3, 1, 2}, {1, 3, 2, 2}, {0, 3, 1, 3}, {1, 3, 2, 2}},
  {{0, 3, 1, 3}, {1, 2, 2, 1}, {0, 1, 0, 1}, {0, 2, 1, 2}}}}
------------------------------------------------------------------------------
target:[C, H, W] filter:[C, FH, FW]
x ..
{{{0, 0, 0, 0, 1},
  {0, 0, 1, 1, 0},
  {1, 1, 1, 0, 0},
  {0, 1, 0, 0, 1},
  {1, 1, 0, 1, 1}},

 {{1, 0, 0, 0, 1},
  {0, 1, 0, 0, 0},
  {1, 0, 1, 1, 0},
  {0, 1, 0, 1, 0},
  {0, 1, 1, 1, 0}},

 {{0, 1, 0, 1, 1},
  {0, 0, 0, 0, 0},
  {0, 1, 1, 1, 1},
  {1, 1, 0, 1, 0},
  {0, 1, 0, 0, 1}}}
model .. x |*| g
x.shape .. [3, 5, 5]
g .. <gear@conv2d:filter_num=none:channel_num=3:size=(2,2):strides=(1,1):padding=valid:channel_pos=first>
x.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{0, 0, 0, 0, 1},
  {0, 0, 1, 1, 0},
  {1, 1, 1, 0, 0},
  {0, 1, 0, 0, 1},
  {1, 1, 0, 1, 1}},

 {{1, 0, 0, 0, 1},
  {0, 1, 0, 0, 0},
  {1, 0, 1, 1, 0},
  {0, 1, 0, 1, 0},
  {0, 1, 1, 1, 0}},

 {{0, 1, 0, 1, 1},
  {0, 0, 0, 0, 0},
  {0, 1, 1, 1, 1},
  {1, 1, 0, 1, 0},
  {0, 1, 0, 0, 1}}}
g.array.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{0, 0},
  {1, 0}},

 {{1, 1},
  {1, 1}},

 {{1, 0},
  {1, 0}}}
== OK ==
strDirect ..
{{2, 2, 1, 3},
 {3, 4, 4, 2},
 {3, 5, 4, 4},
 {4, 6, 3, 4}}
strTrainer ..
{{2, 2, 1, 3},
 {3, 4, 4, 2},
 {3, 5, 4, 4},
 {4, 6, 3, 4}}
------------------------------------------------------------------------------
target:[C, H, W] filter:[FN, C, FH, FW]
x ..
{{{0, 0, 0, 0, 1},
  {0, 0, 1, 1, 0},
  {1, 1, 1, 0, 0},
  {0, 1, 0, 0, 1},
  {1, 1, 0, 1, 1}},

 {{1, 0, 0, 0, 1},
  {0, 1, 0, 0, 0},
  {1, 0, 1, 1, 0},
  {0, 1, 0, 1, 0},
  {0, 1, 1, 1, 0}},

 {{0, 1, 0, 1, 1},
  {0, 0, 0, 0, 0},
  {0, 1, 1, 1, 1},
  {1, 1, 0, 1, 0},
  {0, 1, 0, 0, 1}}}
model .. x |*| g
x.shape .. [3, 5, 5]
g .. <gear@conv2d:filter_num=4:channel_num=3:size=(2,2):strides=(1,1):padding=valid:channel_pos=first>
x.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{0, 0, 0, 0, 1},
  {0, 0, 1, 1, 0},
  {1, 1, 1, 0, 0},
  {0, 1, 0, 0, 1},
  {1, 1, 0, 1, 1}},

 {{1, 0, 0, 0, 1},
  {0, 1, 0, 0, 0},
  {1, 0, 1, 1, 0},
  {0, 1, 0, 1, 0},
  {0, 1, 1, 1, 0}},

 {{0, 1, 0, 1, 1},
  {0, 0, 0, 0, 0},
  {0, 1, 1, 1, 1},
  {1, 1, 0, 1, 0},
  {0, 1, 0, 0, 1}}}
g.array.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{{0, 0},
   {1, 0}},

  {{1, 1},
   {1, 1}},

  {{1, 0},
   {1, 0}}},


 {{{1, 1},
   {0, 1}},

  {{0, 1},
   {1, 0}},

  {{0, 1},
   {1, 0}}},


 {{{1, 1},
   {0, 1}},

  {{1, 1},
   {1, 0}},

  {{1, 0},
   {1, 0}}},


 {{{0, 0},
   {1, 1}},

  {{0, 0},
   {0, 0}},

  {{1, 1},
   {0, 1}}}}
== OK ==
strDirect ..
{{{2, 1, 1, 1}, {2, 2, 3, 2}, {1, 2, 1, 3}, {3, 3, 3, 3}},
 {{3, 3, 3, 3}, {4, 3, 4, 3}, {4, 4, 4, 2}, {2, 3, 3, 1}},
 {{3, 5, 5, 3}, {5, 6, 6, 3}, {4, 3, 4, 3}, {4, 4, 5, 3}},
 {{4, 4, 4, 5}, {6, 3, 5, 2}, {3, 4, 3, 2}, {4, 3, 5, 4}}}
strTrainer ..
{{{2, 1, 1, 1}, {2, 2, 3, 2}, {1, 2, 1, 3}, {3, 3, 3, 3}},
 {{3, 3, 3, 3}, {4, 3, 4, 3}, {4, 4, 4, 2}, {2, 3, 3, 1}},
 {{3, 5, 5, 3}, {5, 6, 6, 3}, {4, 3, 4, 3}, {4, 4, 5, 3}},
 {{4, 4, 4, 5}, {6, 3, 5, 2}, {3, 4, 3, 2}, {4, 3, 5, 4}}}
------------------------------------------------------------------------------
target:[N, C, H, W] filter:[FN, C, FH, FW]
x ..
{{{{0, 0, 0, 0, 1},
   {0, 0, 1, 1, 0},
   {1, 1, 1, 0, 0},
   {0, 1, 0, 0, 1},
   {1, 1, 0, 1, 1}},

  {{1, 0, 0, 0, 1},
   {0, 1, 0, 0, 0},
   {1, 0, 1, 1, 0},
   {0, 1, 0, 1, 0},
   {0, 1, 1, 1, 0}},

  {{0, 1, 0, 1, 1},
   {0, 0, 0, 0, 0},
   {0, 1, 1, 1, 1},
   {1, 1, 0, 1, 0},
   {0, 1, 0, 0, 1}}},


 {{{0, 0, 1, 0, 1},
   {1, 1, 1, 1, 0},
   {1, 0, 1, 1, 0},
   {1, 0, 1, 1, 0},
   {0, 1, 1, 0, 1}},

  {{1, 0, 1, 1, 1},
   {1, 0, 1, 0, 1},
   {0, 0, 0, 1, 1},
   {0, 0, 0, 0, 1},
   {1, 0, 1, 0, 0}},

  {{1, 1, 1, 1, 0},
   {1, 1, 0, 1, 0},
   {0, 1, 0, 0, 0},
   {1, 0, 1, 0, 1},
   {0, 1, 1, 0, 0}}},


 {{{0, 1, 0, 0, 1},
   {1, 0, 1, 1, 0},
   {0, 0, 1, 0, 1},
   {0, 0, 1, 0, 0},
   {0, 1, 0, 0, 1}},

  {{1, 0, 1, 0, 0},
   {1, 1, 1, 0, 1},
   {0, 0, 1, 1, 1},
   {1, 1, 1, 1, 1},
   {0, 1, 0, 1, 1}},

  {{1, 0, 0, 1, 0},
   {1, 0, 0, 0, 0},
   {0, 0, 1, 1, 1},
   {0, 0, 0, 1, 1},
   {0, 1, 1, 0, 1}}}}
model .. x |*| g
x.shape .. [3, 3, 5, 5]
g .. <gear@conv2d:filter_num=4:channel_num=3:size=(2,2):strides=(1,1):padding=valid:channel_pos=first>
x.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{{0, 0, 0, 0, 1},
   {0, 0, 1, 1, 0},
   {1, 1, 1, 0, 0},
   {0, 1, 0, 0, 1},
   {1, 1, 0, 1, 1}},

  {{1, 0, 0, 0, 1},
   {0, 1, 0, 0, 0},
   {1, 0, 1, 1, 0},
   {0, 1, 0, 1, 0},
   {0, 1, 1, 1, 0}},

  {{0, 1, 0, 1, 1},
   {0, 0, 0, 0, 0},
   {0, 1, 1, 1, 1},
   {1, 1, 0, 1, 0},
   {0, 1, 0, 0, 1}}},


 {{{0, 0, 1, 0, 1},
   {1, 1, 1, 1, 0},
   {1, 0, 1, 1, 0},
   {1, 0, 1, 1, 0},
   {0, 1, 1, 0, 1}},

  {{1, 0, 1, 1, 1},
   {1, 0, 1, 0, 1},
   {0, 0, 0, 1, 1},
   {0, 0, 0, 0, 1},
   {1, 0, 1, 0, 0}},

  {{1, 1, 1, 1, 0},
   {1, 1, 0, 1, 0},
   {0, 1, 0, 0, 0},
   {1, 0, 1, 0, 1},
   {0, 1, 1, 0, 0}}},


 {{{0, 1, 0, 0, 1},
   {1, 0, 1, 1, 0},
   {0, 0, 1, 0, 1},
   {0, 0, 1, 0, 0},
   {0, 1, 0, 0, 1}},

  {{1, 0, 1, 0, 0},
   {1, 1, 1, 0, 1},
   {0, 0, 1, 1, 1},
   {1, 1, 1, 1, 1},
   {0, 1, 0, 1, 1}},

  {{1, 0, 0, 1, 0},
   {1, 0, 0, 0, 0},
   {0, 0, 1, 1, 1},
   {0, 0, 0, 1, 1},
   {0, 1, 1, 0, 1}}}}
g.array.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{{1, 1},
   {1, 0}},

  {{1, 1},
   {1, 0}},

  {{1, 0},
   {1, 1}}},


 {{{1, 1},
   {1, 1}},

  {{1, 0},
   {0, 0}},

  {{1, 1},
   {0, 1}}},


 {{{0, 0},
   {1, 0}},

  {{0, 1},
   {0, 1}},

  {{0, 1},
   {1, 1}}},


 {{{1, 1},
   {1, 0}},

  {{0, 1},
   {0, 0}},

  {{0, 1},
   {0, 1}}}}
== OK ==
strDirect ..
{{{{1, 2, 2, 1}, {2, 2, 0, 0}, {1, 3, 2, 2}, {4, 4, 3, 4}},
  {{4, 3, 3, 3}, {5, 5, 4, 3}, {6, 4, 4, 4}, {4, 2, 2, 2}},
  {{5, 6, 4, 4}, {7, 5, 4, 5}, {5, 5, 4, 4}, {4, 4, 2, 1}},
  {{5, 6, 5, 5}, {6, 4, 3, 2}, {2, 2, 3, 2}, {6, 6, 2, 3}}},

 {{{6, 6, 4, 3}, {5, 5, 5, 4}, {7, 7, 4, 5}, {6, 4, 4, 3}},
  {{6, 7, 3, 5}, {5, 4, 2, 3}, {4, 6, 3, 4}, {5, 3, 3, 3}},
  {{3, 3, 3, 3}, {3, 4, 1, 2}, {5, 4, 3, 4}, {5, 4, 4, 4}},
  {{4, 4, 1, 2}, {4, 5, 5, 4}, {6, 4, 2, 3}, {2, 3, 2, 3}}},

 {{{6, 4, 3, 2}, {3, 2, 2, 2}, {3, 4, 2, 2}, {3, 3, 2, 2}},
  {{4, 3, 1, 2}, {4, 4, 3, 3}, {7, 5, 4, 4}, {5, 3, 4, 3}},
  {{1, 0, 1, 0}, {3, 3, 3, 3}, {7, 6, 5, 5}, {7, 5, 5, 4}},
  {{3, 3, 3, 2}, {7, 4, 4, 4}, {4, 3, 4, 3}, {5, 5, 4, 3}}}}
strTrainer ..
{{{{1, 2, 2, 1}, {2, 2, 0, 0}, {1, 3, 2, 2}, {4, 4, 3, 4}},
  {{4, 3, 3, 3}, {5, 5, 4, 3}, {6, 4, 4, 4}, {4, 2, 2, 2}},
  {{5, 6, 4, 4}, {7, 5, 4, 5}, {5, 5, 4, 4}, {4, 4, 2, 1}},
  {{5, 6, 5, 5}, {6, 4, 3, 2}, {2, 2, 3, 2}, {6, 6, 2, 3}}},

 {{{6, 6, 4, 3}, {5, 5, 5, 4}, {7, 7, 4, 5}, {6, 4, 4, 3}},
  {{6, 7, 3, 5}, {5, 4, 2, 3}, {4, 6, 3, 4}, {5, 3, 3, 3}},
  {{3, 3, 3, 3}, {3, 4, 1, 2}, {5, 4, 3, 4}, {5, 4, 4, 4}},
  {{4, 4, 1, 2}, {4, 5, 5, 4}, {6, 4, 2, 3}, {2, 3, 2, 3}}},

 {{{6, 4, 3, 2}, {3, 2, 2, 2}, {3, 4, 2, 2}, {3, 3, 2, 2}},
  {{4, 3, 1, 2}, {4, 4, 3, 3}, {7, 5, 4, 4}, {5, 3, 4, 3}},
  {{1, 0, 1, 0}, {3, 3, 3, 3}, {7, 6, 5, 5}, {7, 5, 5, 4}},
  {{3, 3, 3, 2}, {7, 4, 4, 4}, {4, 3, 4, 3}, {5, 5, 4, 3}}}}
------------------------------------------------------------------------------
target:[H, W, C] filter:[FH, FW, C]
model .. x |*| g
x.shape .. [5, 5, 3]
g .. <gear@conv2d:filter_num=none:channel_num=3:size=(2,2):strides=(1,1):padding=valid:channel_pos=last>
x.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{0, 0, 0}, {0, 1, 0}, {0, 1, 1}, {0, 1, 1}, {1, 0, 0}},
 {{0, 1, 0}, {0, 1, 1}, {1, 0, 1}, {1, 1, 0}, {0, 0, 1}},
 {{0, 1, 0}, {0, 0, 1}, {0, 1, 1}, {0, 0, 1}, {0, 1, 0}},
 {{0, 1, 1}, {1, 0, 0}, {1, 0, 1}, {1, 0, 0}, {0, 0, 0}},
 {{0, 1, 1}, {1, 1, 1}, {1, 0, 1}, {0, 0, 1}, {0, 0, 1}}}
g.array.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{0, 0, 1}, {0, 1, 1}},
 {{1, 1, 1}, {0, 1, 0}}}
== OK ==
strDirect ..
{{3, 4, 6, 3},
 {3, 4, 4, 3},
 {3, 4, 4, 3},
 {4, 4, 3, 1}}
strTrainer ..
{{3, 4, 6, 3},
 {3, 4, 4, 3},
 {3, 4, 4, 3},
 {4, 4, 3, 1}}
------------------------------------------------------------------------------
target:[H, W, C] filter:[FN, FH, FW, C]
model .. x |*| g
x.shape .. [5, 5, 3]
g .. <gear@conv2d:filter_num=4:channel_num=3:size=(2,2):strides=(1,1):padding=valid:channel_pos=last>
x.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{0, 0, 0}, {0, 1, 0}, {0, 1, 1}, {0, 1, 1}, {1, 0, 0}},
 {{0, 1, 0}, {0, 1, 1}, {1, 0, 1}, {1, 1, 0}, {0, 0, 1}},
 {{0, 1, 0}, {0, 0, 1}, {0, 1, 1}, {0, 0, 1}, {0, 1, 0}},
 {{0, 1, 1}, {1, 0, 0}, {1, 0, 1}, {1, 0, 0}, {0, 0, 0}},
 {{0, 1, 1}, {1, 1, 1}, {1, 0, 1}, {0, 0, 1}, {0, 0, 1}}}
g.array.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{{0, 0, 1}, {0, 1, 1}},
  {{1, 1, 1}, {0, 1, 0}}},

 {{{1, 1, 0}, {1, 0, 1}},
  {{1, 0, 0}, {1, 1, 0}}},

 {{{1, 1, 0}, {1, 1, 1}},
  {{1, 0, 1}, {0, 1, 0}}},

 {{{0, 0, 1}, {1, 0, 0}},
  {{0, 0, 1}, {1, 0, 1}}}}
== OK ==
strDirect ..
{{{3, 1, 2, 1}, {4, 3, 4, 3}, {6, 5, 6, 3}, {3, 3, 3, 3}},
 {{3, 2, 3, 1}, {4, 4, 5, 4}, {4, 2, 4, 4}, {3, 4, 5, 1}},
 {{3, 3, 3, 2}, {4, 3, 3, 3}, {4, 4, 4, 3}, {3, 1, 2, 1}},
 {{4, 4, 4, 5}, {4, 5, 5, 4}, {3, 3, 4, 4}, {1, 1, 2, 2}}}
strTrainer ..
{{{3, 1, 2, 1}, {4, 3, 4, 3}, {6, 5, 6, 3}, {3, 3, 3, 3}},
 {{3, 2, 3, 1}, {4, 4, 5, 4}, {4, 2, 4, 4}, {3, 4, 5, 1}},
 {{3, 3, 3, 2}, {4, 3, 3, 3}, {4, 4, 4, 3}, {3, 1, 2, 1}},
 {{4, 4, 4, 5}, {4, 5, 5, 4}, {3, 3, 4, 4}, {1, 1, 2, 2}}}
------------------------------------------------------------------------------
target:[N, H, W, C] filter:[FN, FH, FW, C]
model .. x |*| g
x.shape .. [3, 5, 5, 3]
g .. <gear@conv2d:filter_num=4:channel_num=3:size=(2,2):strides=(1,1):padding=valid:channel_pos=last>
x.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{{0, 0, 0}, {0, 1, 0}, {0, 1, 1}, {0, 1, 1}, {1, 0, 0}},
  {{0, 1, 0}, {0, 1, 1}, {1, 0, 1}, {1, 1, 0}, {0, 0, 1}},
  {{0, 1, 0}, {0, 0, 1}, {0, 1, 1}, {0, 0, 1}, {0, 1, 0}},
  {{0, 1, 1}, {1, 0, 0}, {1, 0, 1}, {1, 0, 0}, {0, 0, 0}},
  {{0, 1, 1}, {1, 1, 1}, {1, 0, 1}, {0, 0, 1}, {0, 0, 1}}},

 {{{0, 0, 1}, {0, 1, 1}, {1, 1, 1}, {0, 1, 0}, {1, 1, 0}},
  {{1, 0, 1}, {1, 0, 0}, {1, 1, 0}, {1, 1, 0}, {1, 1, 1}},
  {{1, 0, 1}, {0, 1, 0}, {0, 0, 1}, {1, 0, 0}, {0, 0, 1}},
  {{1, 0, 1}, {0, 0, 1}, {1, 1, 1}, {0, 1, 1}, {0, 1, 0}},
  {{0, 1, 0}, {0, 0, 1}, {0, 1, 0}, {1, 0, 1}, {1, 0, 0}}},

 {{{0, 1, 0}, {0, 1, 1}, {0, 1, 1}, {0, 0, 0}, {1, 0, 1}},
  {{0, 0, 1}, {0, 0, 0}, {1, 0, 0}, {1, 1, 0}, {1, 0, 0}},
  {{1, 1, 1}, {0, 1, 0}, {0, 1, 1}, {1, 1, 1}, {1, 1, 1}},
  {{0, 1, 0}, {1, 1, 1}, {0, 0, 1}, {0, 1, 0}, {0, 0, 0}},
  {{0, 0, 1}, {1, 1, 0}, {0, 0, 1}, {1, 0, 1}, {1, 0, 1}}}}
g.array.tostring(cond(g.channel_pos == `last, 2, 1)) ..
{{{{1, 1, 1}, {0, 1, 1}},
  {{1, 0, 1}, {0, 1, 1}}},

 {{{1, 1, 1}, {1, 1, 0}},
  {{0, 0, 1}, {1, 0, 1}}},

 {{{0, 0, 1}, {0, 0, 1}},
  {{0, 1, 0}, {1, 1, 1}}},

 {{{1, 1, 1}, {0, 0, 1}},
  {{0, 0, 0}, {1, 0, 1}}}}
== OK ==
strDirect ..
{{{{3, 2, 3, 1}, {5, 5, 4, 4}, {7, 5, 4, 4}, {4, 4, 3, 3}},
  {{4, 3, 3, 3}, {6, 5, 4, 4}, {5, 6, 3, 3}, {5, 3, 2, 3}},
  {{3, 3, 3, 3}, {5, 4, 4, 4}, {5, 4, 3, 4}, {3, 2, 1, 1}},
  {{5, 6, 5, 4}, {5, 5, 4, 4}, {5, 5, 2, 3}, {3, 3, 1, 2}}},

 {{{5, 4, 3, 3}, {6, 5, 4, 4}, {6, 5, 4, 4}, {5, 5, 4, 3}},
  {{5, 4, 2, 2}, {3, 4, 2, 2}, {4, 6, 1, 3}, {6, 5, 2, 4}},
  {{6, 5, 2, 3}, {5, 4, 4, 4}, {5, 4, 4, 2}, {4, 2, 3, 2}},
  {{4, 3, 4, 4}, {5, 4, 3, 2}, {6, 6, 5, 6}, {5, 5, 2, 3}}},

 {{{4, 3, 1, 2}, {4, 4, 3, 4}, {4, 3, 3, 3}, {2, 2, 3, 2}},
  {{4, 2, 3, 1}, {2, 2, 3, 1}, {5, 6, 4, 3}, {6, 6, 4, 4}},
  {{6, 6, 5, 5}, {6, 4, 3, 3}, {6, 5, 3, 3}, {5, 5, 3, 4}},
  {{5, 5, 3, 3}, {6, 4, 4, 5}, {4, 5, 3, 3}, {4, 4, 2, 3}}}}
strTrainer ..
{{{{3, 2, 3, 1}, {5, 5, 4, 4}, {7, 5, 4, 4}, {4, 4, 3, 3}},
  {{4, 3, 3, 3}, {6, 5, 4, 4}, {5, 6, 3, 3}, {5, 3, 2, 3}},
  {{3, 3, 3, 3}, {5, 4, 4, 4}, {5, 4, 3, 4}, {3, 2, 1, 1}},
  {{5, 6, 5, 4}, {5, 5, 4, 4}, {5, 5, 2, 3}, {3, 3, 1, 2}}},

 {{{5, 4, 3, 3}, {6, 5, 4, 4}, {6, 5, 4, 4}, {5, 5, 4, 3}},
  {{5, 4, 2, 2}, {3, 4, 2, 2}, {4, 6, 1, 3}, {6, 5, 2, 4}},
  {{6, 5, 2, 3}, {5, 4, 4, 4}, {5, 4, 4, 2}, {4, 2, 3, 2}},
  {{4, 3, 4, 4}, {5, 4, 3, 2}, {6, 6, 5, 6}, {5, 5, 2, 3}}},

 {{{4, 3, 1, 2}, {4, 4, 3, 4}, {4, 3, 3, 3}, {2, 2, 3, 2}},
  {{4, 2, 3, 1}, {2, 2, 3, 1}, {5, 6, 4, 3}, {6, 6, 4, 4}},
  {{6, 6, 5, 5}, {6, 4, 3, 3}, {6, 5, 3, 3}, {5, 5, 3, 4}},
  {{5, 5, 3, 3}, {6, 4, 4, 5}, {4, 5, 3, 3}, {4, 4, 2, 3}}}}
