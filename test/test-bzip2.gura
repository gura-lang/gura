#!/usr/bin/env gura
import(testutil) {*}
import(bzip2)

fs.chdir('test-bzip2')
testcase {
	['sample1', 'sample2', 'sample3'].each {|prefix, i|
		buff = binary()
		bzip2.writer(buff, i + 1).copyfrom(prefix + '.ref')
		printf('compression: %s %s\n', prefix, buff == open(prefix + '.bz2').read())
	}
	['sample1', 'sample2', 'sample3'].each {|prefix|
		printf('decompression: %s %s\n', prefix,
			bzip2.reader(prefix + '.bz2').read() == open(prefix + '.ref').read())
	}
}
